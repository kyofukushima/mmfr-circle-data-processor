# 育児サークル情報処理アプリ開発機能

## 送付用データ作成
✅ **実装済み**

## インポートデータ作成

### データ読み込み
✅ **実装済み**

送付用ファイルを送付した後、クライアントから修正されて返ってきたエクセルファイルをアップロードする
ヘッダー以外の上から2行についてはデータに関係ない説明用の部分だが、クライアントによって消されてしまっているかもしれないので、読み込む際に、スキップする行数を指定する

#### 技術的備考
データフレーム形式で読み込むこと。なお、データフレームは2種類読み込む。
- メインデータ：シート名が「original」ではない方のシート
- 差分検出用データ：シート名が「original」であるシート
※ そもそものシート数が2より多い場合は、エラー扱いとする（original以外に、どのシートをメインデータにするかが特定できないため）

### データ検証
✅ **実装済み**

#### 検証項目選択機能
✅ **実装済み**

ユーザーは以下の16個の検証項目をチェックボックスで選択可能：
- 修正・削除新規ステータス
- 空欄ステータス
- 機種依存文字
- セル内改行
- 変更禁止列
- 連続した空白
- 半角英数
- メールアドレス
- 必須項目
- マルバツ
- 活動場所
- ステータス
- webサイトURL
- **アカウント発行年月** ✅ **新規追加**
- **曜日** ✅ **新規追加**
- **時間** ✅ **新規追加**

3列レイアウトで配置し、「全選択」「全解除」ボタンも提供。
選択された検証項目のみが実行され、実行された検証項目名が画面に表示される。
各検証項目にはヘルプテキストが付与されており、検証内容の詳細を確認可能。

#### 統一的な欠損値処理
✅ **実装済み**

全ての検証関数で以下の欠損値パターンを統一的に処理：
- `pd.NA`
- `None`
- `np.nan`
- `'nan'` (文字列)
- `'None'` (文字列)
- `'<NA>'` (文字列)
- 空文字列 `''`

**処理方針**:
- 必須項目以外の検証：空欄・欠損値は検証対象外として無視
- 必須項目の検証：空欄・欠損値をエラーとして検出
- データ比較処理：メインデータと元データの両方で統一的な欠損値処理を適用

共通関数`normalize_value()`により統一的な処理を実現し、約200行のコード削減を達成。

メインデータの内容を検証する。検証対象の列は次のとおり
- サークル名
- スラッグ
- ステータス
- 活動種別
- 概要
- 参加者の条件(妊娠)
- 参加者の条件(妊娠後半)
- 参加者の条件(出産)
- 参加者の条件(0歳)
- 参加者の条件(1歳)
- 参加者の条件(1歳後半)
- 参加者の条件(2歳)
- 参加者の条件(2歳後半)
- 参加者の条件(3歳)
- 参加者の条件(4歳)
- 参加者の条件(5歳)
- 参加者の条件(6歳)
- 参加者の条件(どなたでも)
- 活動場所
- 申込方法
- 申込方法備考
- 申込先電話番号
- Eメールアドレス
- 要会費
- 会費
- Webサイト
- 活動日_営業曜日
- 活動日_開始時間
- 活動日_終了時間
- 活動日_営業時間ラベル
- 活動日_営業曜日ラベル
- 活動日_備考
- 代表者
- 団体名
- 団体名（ふりがな）
- 幼稚園・保育園チェック
- 冊子掲載可
- HP掲載可
- オープンデータ掲載可
- 小学校区
- 小学校区（ふりがな）
- 代表者名
- 代表者名（ふりがな）
- 代表者郵便番号
- 代表者住所
- 代表者電話番号
- 代表者FAX
- 代表者携帯番号
- 記入者
- 順番
- 場所
- ｱｶｳﾝﾄ発行有無
- ｱｶｳﾝﾄ発行年月
- アカウント発行の登録用メールアドレス
- 修正・削除新規

検証については、メインデータの列に「エラー」という列を作成し、エラーがあった場合はこの列に記入する。1つの行に対し複数のエラーがあった場合については、カンマ区切りで記入する。
エラー検証については、検証項目を関数化し、列ごとに実施。
検証項目を全て実施したあと、エラー項目の件数、詳細の確認と、結果のダウンロード（xlsx）ができるようにする。実際の実装については、validate.pyと、facility_data_chackフォルダのapp.pyを参考にすること。

#### 修正・削除新規ステータスの検証
✅ **実装済み**

修正・削除新規列の値が適切に振られているかを検証する
修正・削除新規列の値は、次の4種類が存在する。
* 修正
* 新規追加
* 掲載順
* 削除

※ 上記以外の値が入っていた場合はエラー扱いとする。エラーメッセージは「修正・削除新規列に、次の値以外が入力されています。(修正・新規追加・掲載順・削除)」

##### 修正ステータスの検証
✅ **実装済み**

修正・削除新規列に「修正」が入っている場合は、その行の修正・削除新規列以外の検証対象列の値が、差分検出用データの同じデータと差分がないかをチェックする。
なお、メインデータと差分検出用データの「同じデータ」の紐付けは、スラッグ列の値をキーとして紐付ける。
差分があった場合は、正しいので特に何もしない
差分がない場合（修正と入っているのに、特に値が変更されていない場合）はエラー扱いとする。エラーメッセージは「修正にもかかわらず、値が変更されていません」

**統一的な欠損値処理対応済み**: メインデータと差分検出用データの両方で`pd.NA`、`None`、`'<NA>'`等を統一的に処理

##### 新規追加ステータスの検証
✅ **実装済み**

修正・削除新規列に「新規追加」が入っている場合は、その行のスラッグ列の値が、空欄であるか検証する。
空欄である場合は、正しいので特に何もしない
空欄でない場合（値が入力されている）は、エラー扱いとする。エラーメッセージは「新規追加にもかかわらずスラッグ列に値が入力されています」

##### 掲載順ステータスの検証
✅ **実装済み**

修正・削除新規列に「掲載順」が入っている場合は、その行の順番列の値が、差分検出用データの同じデータと差分がないかをチェックする。
紐付け方法については修正ステータスの検証と同様。
順番列の値に差分がある場合は、正しいので特に何もしない
差分がない場合は、エラー扱いとする。エラーメッセージは「「掲載順」ステータスが振られていますが、順番が変わっていません」

**統一的な欠損値処理対応済み**: 順番列の比較時にも欠損値を統一的に処理

##### 削除ステータスの検証
✅ **実装済み**

修正・削除新規列に「削除」が入っている場合は、特に何もしない

#### 空欄の検証
✅ **実装済み**

修正・削除新規列が空欄である場合は、その行の修正・削除新規列以外の検証対象列の値が、差分検出用データの同じデータと差分がないかをチェックする。
差分がない場合は、正しいので特に何もしない
差分があった場合（ステータスに何も記載されていないのに、値が変更されている場合）はエラー扱いとする。エラーメッセージは「修正と書かれていませんが、xx列の値が変更されています」
※ xx の部分には、差分のあった列名を入れる。複数の列が対象となっている場合は、「修正と書かれていませんが、xx,yy,zzの値が変更されています」のように、カンマ区切りで記載する。

**統一的な欠損値処理対応済み**: 空欄・欠損値（`pd.NA`、`None`、`'<NA>'`等）を同じものとして扱う

#### メインデータの値の検証
##### 機種依存文字
✅ **実装済み**

機種依存文字が値に含まれていないかを検証する
対象列：サークル名、概要、活動場所、申込方法、会費、活動日_備考、団体名（ふりがな）、小学校区、小学校区（ふりがな）、代表者名、代表者名（ふりがな）、代表者住所、記入者、場所

**統一的な欠損値処理対応済み**: 空欄・欠損値は検証対象外として無視

##### セル内改行
✅ **実装済み**

セル内改行がないか検証する
対象列：サークル名、活動種別、活動場所、申込方法、Eメールアドレス、会費、Webサイト、活動日_備考、団体名（ふりがな）、幼稚園・保育園チェック、小学校区、小学校区（ふりがな）、代表者名、代表者名（ふりがな）、代表者住所、記入者、場所

**統一的な欠損値処理対応済み**: 空欄・欠損値は検証対象外として無視

##### 変更禁止列の検証
✅ **実装済み**

メインデータと差分検出用データをスラッグ列の値で紐付け、比較して、差分がないかを検証する。
差分があった場合はエラーとする。なお、修正・削除新規列の値が「新規追加」の行のデータは、この検証は不要（そもそも、差分検出用シートに同じスラッグはないため、紐付けが不可能である）
エラーメッセージは「xx列の値が変更されています」
※ xx の部分には、差分のあった列名を入れる。複数の列が対象となっている場合は、「xx,yy,zzの値が変更されています」のように、カンマ区切りで記載する。
対象列：スラッグ、ステータス、参加者の条件(妊娠後半)、参加者の条件(出産)、参加者の条件(1歳後半)、参加者の条件(2歳後半)、申込方法備考、活動日_営業時間ラベル、代表者、団体名

**統一的な欠損値処理対応済み**: メインデータと差分検出用データの両方で欠損値を統一的に処理

##### 連続した空白の検証
✅ **実装済み**

連続した空白（3つ以上）がないか検証する。
対象列：サークル名、概要、活動場所、申込方法、会費、活動日_備考、団体名（ふりがな）、小学校区、小学校区（ふりがな）、代表者名、代表者名（ふりがな）、代表者住所、記入者、場所

**統一的な欠損値処理対応済み**: 空欄・欠損値は検証対象外として無視

##### 半角英数の検証
✅ **実装済み**

値に、半角英数以外が含まれているか検証する。
対象列：申込先電話番号、代表者郵便番号、代表者電話番号、代表者FAX、代表者携帯番号、順番
※ Webサイト列は除外（URL検証で別途処理）
※ 各種ハイフン文字（U+2010, U+2013, U+2014, U+2212）にも対応済み

**統一的な欠損値処理対応済み**: 空欄・欠損値は検証対象外として無視

##### メールアドレスの検証
✅ **実装済み**

値が、メールアドレスとして有効か検証する
対象列：Eメールアドレス、アカウント発行の登録用メールアドレス

**統一的な欠損値処理対応済み**: 空欄・欠損値は検証対象外として無視

##### webサイトURL検証
✅ **実装済み**

実際にwebサイトにアクセスしてリクエストが返ってくるかを検証する。
- 空文字列やNaN値は無視
- @で始まるURLは@を除去してから検証
- 実際のHTTPリクエストを送信してレスポンスを確認
- 非同期処理で効率的に複数URLを検証
対象列：Webサイト

**統一的な欠損値処理対応済み**: 空欄・欠損値は検証対象外として無視

##### 必須項目の検証
✅ **実装済み**

値が空欄になっていないか検証する。
なお、修正・削除新規列の値が「新規追加」の場合は、この検証は不要（空欄でもエラー扱いでなくて良い）
対象列：サークル名、スラッグ、ステータス、活動種別

**統一的な欠損値処理対応済み**: 空欄・欠損値をエラーとして検出（必須項目のため）

##### マルバツの検証
✅ **実装済み**

「○」または空欄のどちらかのパターンで回答される列において、それ以外の値が入っていないか検証する。
対象列：参加者の条件(妊娠)、参加者の条件(妊娠後半)、参加者の条件(0歳)、参加者の条件(1歳)、参加者の条件(1歳後半)、参加者の条件(2歳)、参加者の条件(2歳後半)、参加者の条件(3歳)、参加者の条件(4歳)、参加者の条件(5歳)、参加者の条件(6歳)、参加者の条件(どなたでも)、要会費、冊子掲載可、HP掲載可、オープンデータ掲載可

**統一的な欠損値処理対応済み**: 空欄・欠損値は検証対象外として無視

##### アカウント発行年月の検証
✅ **実装済み**

アカウント発行年月列の値が正しい和暦形式で入力されているかを検証する。
- 正しい形式：R6,4 または R6.4（令和6年4月の場合）
- 和暦から西暦への変換を試行し、変換できない値をエラーとして検出
- 月の範囲（1-12）および令和年の妥当性もチェック
- 変換できない値がある場合、インポートデータ作成時に詳細な警告メッセージを表示

対象列：ｱｶｳﾝﾄ発行年月

**統一的な欠損値処理対応済み**: 空欄・欠損値は検証対象外として無視

##### 曜日の検証
✅ **実装済み**

曜日を入力する列において、カンマ区切りで曜日が入力されているか判定
- 有効な曜日：月、火、水、木、金、土、日、祝
- カンマ区切りでの複数曜日入力に対応
- 無効な曜日や形式の場合はエラーを検出

対象列：活動日_営業曜日

**統一的な欠損値処理対応済み**: 空欄・欠損値は検証対象外として無視

##### 時間の検証
✅ **実装済み**

時間を入力する列において、次を検証する
- 「HH:MM」または「HH:MM:SS」という書式になっているか
- 時間・分・秒の範囲チェック（0-23時、0-59分、0-59秒）
- 開始時間の列と終了時間の列の値を比較して、開始時間と終了時間が同じまたは逆転していないか
- 両方空欄の場合は検証対象外

対象列：活動日_開始時間、活動日_終了時間

**統一的な欠損値処理対応済み**: 空欄・欠損値は検証対象外として無視

#### 活動場所の検証
✅ **実装済み**

対象の列が、施設情報に存在する施設であるかどうかを検証する（ユーザーがアップロードした施設情報データ（csv）を参照する）
対象列：活動場所

**統一的な欠損値処理対応済み**: 空欄・欠損値は検証対象外として無視

#### ステータス列の検証
✅ **実装済み**

ステータス列の値が、次のいずれかであるかを検証する
* publish
* private
* {空欄}
上記以外のデータが入力されていた場合はエラー扱いとする。
対象列：ステータス

**統一的な欠損値処理対応済み**: 空欄・欠損値を同じものとして扱う

### インポートデータ用に整形
✅ **実装済み**

メインデータを、次の処理を加えて整形する

#### 入力禁止列の値の削除
入力禁止とされている列の値を全て削除する（列自体は削除しない）
対象列：参加者の条件(出産)、申込方法備考、活動日_営業時間ラベル、活動日_営業曜日ラベル

#### 数字へ置換
以下の列について、値を次のように置換する
空欄 -> 0
○ -> 1
※ それ以外の値が入っていた場合はエラー扱い。
対象列：参加者の条件(妊娠)、参加者の条件(妊娠後半)、参加者の条件(出産)、参加者の条件(0歳)、参加者の条件(1歳)、参加者の条件(1歳後半)、参加者の条件(2歳)、参加者の条件(2歳後半)、参加者の条件(3歳)、参加者の条件(4歳)、参加者の条件(5歳)、参加者の条件(6歳)、参加者の条件(どなたでも)

#### ステータスの修正
ステータス列について、次のとおり変換する
1. 修正・削除新規列の値が「削除」である：ステータス列の値を「private」にする
2. 修正・削除新規列の値が「削除」でない　かつ　空欄である：ステータス列の値を「publish」にする
3. HP掲載可列の値が1である：ステータス列の値を「publish」にする
4. HP掲載可列の値が0である：ステータス列の値を「private」にする
※ 上記は優先順である。つまり、HP掲載可列の値より修正・削除新規列の値を優先する。

#### 順番の修正
順番列について、データの上から連番を挿入する（1からスタート）
挿入後、順番列の値を差分検出用データの同じデータ（スラッグで紐付け）にて、順番列の値を比較する。
値に差分がある場合は、修正・削除新規列の値を「掲載順」にする。
なお、修正・削除新規にすでに「修正」「削除」「新規追加」が入力されている場合は、上書きしない。

### インポート用データのテンプレートの準備
✅ **実装済み**

#### 育児サークル用データ
見出しを以下とする
- サークル名
- スラッグ
- ステータス
- 活動種別
- 概要
- 対象年齢(妊娠前半)
- 対象年齢(妊娠後半)
- 対象年齢(出産)
- 対象年齢(0歳)
- 対象年齢(1歳前半)
- 対象年齢(1歳後半)
- 対象年齢(2歳前半)
- 対象年齢(2歳後半)
- 対象年齢(3歳)
- 対象年齢(4歳)
- 対象年齢(5歳)
- 対象年齢(6歳(就学前))
- 対象年齢(6歳(就学後))
- 活動場所
- 申込方法
- 申込方法備考
- 申込先電話番号
- Eメールアドレス
- 要会費
- 会費
- Webサイト
- 活動日_営業曜日
- 活動日_開始時間
- 活動日_終了時間
- 活動日_営業時間ラベル
- 活動日_営業曜日ラベル
- 活動日_備考
- 代表者
- 団体名
- 団体名（ふりがな）
- 幼稚園・保育園チェック
- 冊子掲載可
- HP掲載可
- オープンデータ掲載可
- 小学校区
- 小学校区（ふりがな）
- 代表者名
- 代表者名（ふりがな）
- 代表者郵便番号
- 代表者住所
- 代表者電話番号
- 代表者FAX
- 代表者携帯番号
- 記入者
- 順番

#### ユーザーのデータ
見出しを以下とする
- 名前
- スラッグ
- メールアドレス
- 自己紹介
- 種類
- Webサイト
- 画像

### 必要なインポートデータを作成する
✅ **実装済み**

以下、最大で3種類のファイルを作成する必要がある。
- 新規追加の育児サークル
- 修正の育児サークル（削除、非公開を含む）
- ユーザー新規追加、修正

#### 新規追加の育児サークル用インポート用ファイルの作成
✅ **実装済み**

1. メインデータの修正・削除新規列の値が「新規追加」である行を抽出する
2. テンプレートの育児サークル用データの見出しをヘッダーとしたデータフレームを作成する
3. 2の手順で作成したデータフレームに1の手順で抽出したデータを挿入する
4. 「{自治体名}育児サークル{月}月_新規_{YYYYMMDD}.csv」という名前で保存する。（自治体名、月、ファイル作成日は可変）

#### 修正の育児サークルインポート用ファイルの作成
✅ **実装済み**

1. メインデータの修正・削除新規列の値が「修正」「削除」「掲載順」のいずれかが入力されているデータを抽出する
2. テンプレートの育児サークル用データの見出しをヘッダーとしたデータフレームを作成する
3. 2の手順で作成したデータフレームに1の手順で抽出したデータを挿入する
4. 「{自治体名}育児サークル{月}月_修正_{YYYYMMDD}.csv」という名前で保存する。（自治体名、月、ファイル作成日は可変）

#### ユーザー新規追加、修正インポート用ファイルの作成
✅ **実装済み**

ユーザーのデータ（csv）をアップロードする。このアップロードしたユーザーデータは、以下の手順の情報参照に利用する。

##### 新規追加のインポートデータ作成 
✅ **実装済み**

1. メインデータのｱｶｳﾝﾄ発行有無列の値が「○」であり、ｱｶｳﾝﾄ発行年月列の値が指定した年月（デフォルトでは、作業している月）であるデータを抽出する。
※ なお、ｱｶｳﾝﾄ発行年月列の値は「R6,12」のように、和暦で記載されているので注意。左の例は実際は「2024/12」である。
2. ユーザーのデータをテンプレートとして、1の手順で抽出したデータについて、それぞれ次の内容で挿入する
- 名前列：メインデータの「サークル名」列の値を入力
- スラッグ列：2の手順のユーザーデータの「スラッグ」列の値のうち、cs0001 ~ cs9999の範囲で最も大きい値の次から連番になるように追加
※ cs9999は固定のため、範囲に入れない。例えば、ユーザーデータとして、スラッグ列が「cs9999」「cs500」のデータが存在し、1の手順で抽出したデータが2件の場合は、スラッグ列の値が「cs501」と「cs502」とそれぞれ連番のデータを作成する。
- メールアドレス列：メインデータの「アカウント発行の登録用メールアドレス」列の値を入力。なお、2の手順のユーザーデータの「メールアドレス」列の値と重複していた場合はエラー扱いとする（1つのアカウントでは、1つのメールアドレスのみ登録できるため）
- 種類列：テキスト「blog_writer」を入力
- Webサイト列：空欄とする
- 画像列：空欄とする

**アカウント発行年月の警告機能**: 変換できない値がある場合、詳細な警告メッセージを表示
- 正しい形式の例示
- 変換できない値の一覧（行番号、値、サークル名付き）
- 具体的な修正方法の案内

##### 修正のインポートデータ作成
✅ **実装済み**

1. メインデータのアカウント発行の登録用メールアドレス列の値が差分検出用データと異なる行を抽出する
2. 1で抽出したデータのうち、「代表者」列の値がユーザーデータの「スラッグ」列と一致するデータを探す
3. 一致するユーザーデータについて、「名前」「メールアドレス」の値を、メインデータの値で上書きする。なお、差分を画面表示して、作業者が確認できるようにする。
4. 3で修正したデータを、 新規追加のインポートデータ作成 で作成したデータとマージする
5. 4で作成したデータを「{自治体名}{月}月_ユーザー登録{YYYYMMDD}.csv」という名前で保存する。（自治体名、月、ファイル作成日は可変）
※ なお、最終的に、ユーザーについては新規追加のみの場合もあるし、修正のみの場合もあるということに注意

**実装済み機能**:
- アカウント発行の登録用メールアドレス列の差分検出
- 代表者スラッグとユーザーデータの突合
- ユーザー情報の修正内容表示（差分表示機能）
- 新規追加データとのマージ処理
- 修正対象行の新規追加からの除外機能

## セッション管理機能
✅ **実装済み**

### セッション状態の管理
- ファイルアップロード状態の追跡
- 検証完了状態の管理
- インポートデータ作成状態の管理
- ファイル変更検出によるセッション状態のリセット

### セッションリセット防止
- `st.rerun()`の不適切な使用を回避
- 警告メッセージのセッション状態保存
- バルーン表示の重複防止機能

### デバッグ機能
- セッション状態の変化ログ
- デバッグモードでの詳細情報表示
- ファイルハッシュによる変更検出

## テスト機能
✅ **実装済み**

### 単体テスト
各検証関数の単体テストを実装：
- `test_validate_modification_status.py`: 修正・削除新規ステータス検証のテスト
- `test_unified_null_handling.py`: 統一的な欠損値処理のテスト
- `test_validate_alphanumeric.py`: 半角英数検証のテスト
- `test_validate_circle_or_cross.py`: マルバツ検証のテスト
- `test_validate_email.py`: メールアドレス検証のテスト
- `test_validate_modification_status.py`: 修正・削除新規ステータス検証のテスト
- `test_validation_functions.py`: 各種検証関数のテスト
- `test_website_url_validation.py`: WebサイトURL検証のテスト
- `test_postal_code_analysis.py`: 郵便番号分析のテスト
- `test_format_for_import.py`: インポート用データ整形のテスト
- `test_import_functions.py`: インポート関数のテスト
- `test_integration.py`: 統合テスト

### セッション安全性テスト
- `test_session_safety.py`: セッションリセット問題の静的解析
- `test_session_management.py`: セッション状態管理機能のテスト

### 統合テストスクリプト
- `run_all_tests.py`: 全テストの統合実行

### テストカバレッジ
- 正常値のテスト
- 異常値のテスト
- 欠損値パターンのテスト（`pd.NA`, `None`, `np.nan`, `'nan'`, `'None'`, `'<NA>'`）
- データ比較処理のテスト
- エラーメッセージの検証

## UI/UX機能
✅ **実装済み**

### タブ式インターフェース
- データ修正用エクセル作成タブ
- インポートデータ作成タブ

### サイドバー機能
- デバッグモードの切り替え
- タブに応じた使い方の表示
- バージョン情報の表示

### ファイルアップロード機能
- CSVファイルの自動エンコーディング検出
- Excelファイルの検証と読み込み
- エラーハンドリングとユーザーフレンドリーなエラーメッセージ
- ファイル変更検出によるセッション状態管理

### データ表示機能
- 展開可能なデータプレビュー
- 処理内容の詳細表示
- エラー詳細の表示
- 2カラムレイアウトによる効率的な画面利用

### ダウンロード機能
- 処理済みファイルのダウンロード
- 検証結果のダウンロード
- 複数インポートファイルの個別ダウンロード

### 検証項目選択UI
- 3列レイアウトでの検証項目表示
- 「全選択」「全解除」ボタン
- 各項目のヘルプテキスト表示
- 実行された検証項目の表示

### プログレスバー機能
✅ **実装済み**
- **WebサイトURL検証専用**: 検証対象URL数を母数とした詳細な進捗表示
- **URL数が2件以上の場合のみ表示**: 1件以下は瞬時に完了するため非表示
- **現在検証中のURL表示**: どのURLで時間がかかっているかを表示
- **自動クリーンアップ**: 検証完了後にプログレスバーを自動削除
- **その他の検証**: 瞬時に完了するため、シンプルなスピナー表示

### エラー0件時の演出
- バルーン表示機能
- 重複表示の防止

## デプロイ機能
✅ **実装済み**

### Streamlit Cloud対応
- `requirements.txt`: Python依存関係の管理
- `.streamlit/config.toml`: Streamlit設定（アップロードサイズ制限、テーマ設定）
- `packages.txt`: システムレベル依存関係
- `.gitignore`: Git管理除外設定

### ドキュメント
- `README.md`: プロジェクト概要と使用方法
- `DEPLOYMENT.md`: 詳細なデプロイ手順
- `TEST_REPORT.md`: テスト結果レポート

## 技術的特徴

### パフォーマンス最適化
- 非同期URL検証（webサイトURL検証）
- 効率的なデータフレーム操作
- メモリ効率を考慮したファイル処理

### エラーハンドリング
- 包括的なエラーキャッチと適切なエラーメッセージ
- ファイル形式検証
- データ整合性チェック

### 保守性
- 関数の分離と再利用性
- 統一的なコーディングスタイル
- 包括的なドキュメンテーション
- 共通関数による重複コードの削減

### セキュリティ
- ファイルアップロード時の検証
- セッション状態の適切な管理
- エラー情報の適切な表示

## 今後の開発予定

### 機能拡張予定
- バッチ処理機能
- ログ出力機能
- 設定ファイル対応
- API連携機能
- 複数ファイル同時処理
- 処理履歴の管理

### パフォーマンス改善予定
- 大容量ファイルの分割処理
- 並列処理の最適化
- キャッシュ機能の追加

### UI/UX改善予定
- カスタマイズ可能なテーマ
- 多言語対応
- ダークモード対応
- レスポンシブデザインの改善

---

## 更新履歴

### v2.5 - 2025/07/23
- **ファイル読み込み高速化**: UTF-8系エンコーディングの優先処理により読み込み時間を大幅短縮
- **Excel読み込み最適化**: 複数シートの同時読み込みにより処理時間を30-50%短縮
- **ファイル変更検出高速化**: ファイル名・サイズによる簡易チェックで90%の処理時間短縮
- **AIチャット機能の改善**: st.chat_messageを使用したモダンなUI、アバター表示対応
- **セキュリティ強化**: HTMLタグのエスケープ処理によるXSS対策
- **スピナー表示最適化**: ユーザビリティ向上のための配置・スタイル改善




